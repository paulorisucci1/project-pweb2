<!DOCTYPE html>
<html lang="en"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:insert="~{layout/layout}"
      th:with="title='Student list', leaveLink=@{'/home'}">
<body>
<header class="text-center">
  <h1>Students</h1>
</header>
<main layout:fragment="content">

  <form th:action="@{/students/form}" method="GET">
    <button class="btn btn-primary" type="submit">New student</button>
  </form>

  <table class="table table-striped table-hover">
    <div th:if="${not #lists.isEmpty(studentList)}">
      <div th:text="'Total of '+${#lists.size(studentList)} + ' students.'" class="text-right"></div>
    </div>
    <thead>
    <tr>
      <th>Registration</th>
      <th>Name</th>
      <th>Institution</th>
      <th>Current Enrollment Receipt Date</th>
      <th>Operations</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="student: ${studentList}">
      <td><a th:text="${student.registration}"></a></td>
      <td><a th:text="${student.name}"></a></td>
      <td><a th:text="${student.institution.acronym}"></a></td>
      <td >
        <a th:if="${student.currentEnrollment == null}" th:href="@{*{'/students/'+student.idStudent+'/enrollments/form'}}">
          <input type="button" value="Add" class="btn btn-secondary"/>
        </a>
        <a th:if="${student.currentEnrollment != null}"
           th:text="${student.currentEnrollment.receiptDate}">
        </a>
      </td>
      <td>
        <form th:action="@{/students/{id}(id=${student.idStudent})}" class="operations-form">
          <button type="submit" class="btn btn-primary btn-sm">Update</button>
        </form>
        <form th:action="@{/students/{id}(id=${student.idStudent})}" th:method="delete" class="operations-form">
          <button type="submit" class="btn btn-primary btn-sm">Exclude</button>
        </form>
      </td>
    </tr>
    </tbody>
  </table>
</main>
</body>
</html>